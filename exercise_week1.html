<script>
    let produk = [
        ["Baju", 15, 25000],
        ["Celana", 10, 30000],
    ]

    const printData = () => {
        let list = '';
        for (let i = 0; i < produk.length; i++) {
            list += `${i + 1}. ${produk[i][0]}, Stok = ${produk[i][1]}, Rp.  ${produk[i][2].toLocaleString('id')}\n`;
        }

        return list;
    }

    while (true) {
        let mainMenu = prompt(`Selamat datang di Toko Kelontong :
        1. Tambah Produk
        2. Beli Produk
        3. Cek Stok`)

        if (mainMenu == 1) {
            let name = prompt('Masukkan nama produk :');
            let stock = parseInt(prompt('Masukkan stok produk :'));
            let price = parseInt(prompt('Masukkan harga produk :'));

            produk.push([name, stock, price]);
            alert(`Produk baru sudah terdaftar ✅\n${printData()}`);
        } else if (mainMenu == 2) {
            // Pilih barang yg dibeli
            let beli = parseInt(prompt(`Silahkan pilih produk :\n${printData()}`))-1;
            while (true) {
                let qty = parseInt(prompt(`Beli ${produk[beli][0]} berapa ?`));

                if (qty <= produk[beli][1]) {
                    let totalBeli = qty * produk[beli][2];
                    let pembayaran = parseInt(prompt(`Total belanja Rp. ${totalBeli.toLocaleString('id')}
        Masukkan uang anda :`));
                    let kembalian = pembayaran - totalBeli;

                    if (kembalian < 0) {
                        alert('Uang tidak cukup, pembelian gagal ❌');
                        break;
                    } else {
                        alert(`Pembelian berhasil ✅
            Kembalian anda adalah Rp. ${kembalian.toLocaleString('id')}`);

                        // Pengurangan stock
                        produk[beli][1] = produk[beli][1]-qty;
                        // Jika barang habis, maka langsung kita hapus
                        if (produk[beli][1] == 0) {
                            produk.splice(beli, 1)
                        }
                        break;
                    }
                }
                else {
                    let transaksi = confirm('Stock tidak cukup, mau input ulang ?')
                    if (!transaksi) {
                        break;
                    }
                }

            }
            // Input qty yg dibeli

        } else if (mainMenu == 3) {
            alert(`Produk tersedia :\n${printData()}`);
        } else {
            alert('Pilihan anda tidak sesuai ❌')
        }

        let logOut = confirm(`Ke menu utama ?`)
        if (logOut == false) {
            alert(`Terima kasih sudah berkunjung 😁`);
            break;
        }

    }

</script>